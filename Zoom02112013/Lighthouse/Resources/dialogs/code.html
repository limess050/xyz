<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Edit HTML Code</title>
<link rel=stylesheet href="../css/MSStandard.css" type="text/css">
<script type="text/javascript" src="../../dojo/dojo.js"></script>
<script type="text/javascript" src="../js/library.js"></script>
<script type="text/javascript" src="../js/wysiwyg.js"></script>
<script type="text/javascript">
var htmlToolbar = opener.dialogParams["htmlToolbar"];
var htmlField = opener.dialogParams["htmlField"];
tableRemoveGuidelines(htmlField.editArea);
var originalContent = opener.cleanUp(htmlField.editArea.innerHTML);

function changeWrap() {
	// Can't change wrap dynamically in Firefox.  Replace textarea instead.
	// https://bugzilla.mozilla.org/show_bug.cgi?id=41464
	var newDiv = document.createElement("TEXTAREA");
	newDiv.id = "newContent";
	newDiv.value = document.getElementById("newContent").value;
	if (document.getElementById("wrap").checked) {
		newDiv.setAttribute("wrap","soft");
	} else {
		newDiv.setAttribute("wrap","off");
	}
	document.getElementById("newContent").parentNode.replaceChild(newDiv,document.getElementById("newContent"))
}

//OK button pressed
function saveChanges() {
	applyChanges();
	window.close();
}
//Apply button pressed
function applyChanges() {
	htmlField.editArea.innerHTML = document.getElementById("newContent").value;
}
//Cancel button pressed
function cancelChanges() {
	htmlField.editArea.innerHTML = originalContent;
	window.close();
}
//Set table guidelines when window is closed, even if a button isn't pressed.
window.onunload = function() {
	tableSetGuidelines(htmlField.editArea);
}

</script>
<style>
textarea#newContent {
	width:100%;
	height:470px;
	font-family:monospace !important;
	font-size:13px;
}
</style>
</head>
<body id="dialog" onload="document.getElementById('newContent').value = originalContent;">
<form>
<h1>Edit HTML Code</h1>
<p><textarea id="newContent" wrap="off"></textarea></p>
<div style="float:right"><input type="checkbox" id="wrap" onclick="changeWrap()"><label for=wrap>Wrap long lines</label></div>
<input type=submit value=OK class="button" onclick="saveChanges()">
<input type=button value=Cancel class="button" onclick="cancelChanges()">
<input type=button value=Apply class="button" onclick="applyChanges()">
</form>
</body>
</html>